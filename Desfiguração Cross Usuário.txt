Desfiguração Cross-Usuário

Descrição

Um atacante pode fazer um único pedido para um servidor vulnerável que fará com que o servidor  crie duas respostas, o segundo dos quais pode ser interpretado como uma resposta a um pedido diferente, possivelmente, uma feita por outro usuário que compartilhar a mesma conexão TCP com o servidor . Isso pode ser feito, convencendo o usuário a enviar o pedido malicioso em si, ou remotamente em situações em que o atacante compartilhe com o usuário uma conexão TCP comum para o servidor, como um servidor proxy compartilhado. No melhor dos casos, um atacante pode aproveitar essa habilidade para convencer os usuários de que o pedido tenha sido hackeado, causando aos usuários a perda de confiança na segurança da aplicação. No pior dos casos, um atacante pode fornecer conteúdo especialmente criado projetado para e imitar o comportamento da aplicação, mas redirecionar informações pessoais, como números de contas e senhas, de volta para o atacante.
Este ataque é bastante difícil de realizar no ambiente real. A lista de condições é longa e difícil de realizar pelo atacante.
A Desfiguração Cross-Usuário é possível por causa da divisão de resposta HTTP e falhas na aplicação web. É crucial do ponto de vista do atacante que o aplicativo permita preencher o cabeçalho campo com mais de um cabeçalho usando CR (Carrige Return) e caracteres LF (Line Feed).

Exemplos

Nós encontramos uma página web, que recebe o nome do serviço a partir da "página" argumento e então redireciona (302) para este serviço.
Exemplo: http://testsite.com/redir.php?page=http://other.testsite.com/
E código exemplar da redir.php:


rezos@spin ~/public_html $ cat redir.php
<?php
header ("Location: " . $_GET['page']);
?>


Elaborando solicitações apropriadas:



/redir.php?page=http://other.testsite.com%0d%0aContent-
Length:%200%0d%0a%0d%0aHTTP/1.1%20200%20OK%0d%0aContent-
Type:%20text/html%0d%0aContent-
Length:%2019%0d%0a%0d%0a<html>deface</html>


Servidor HTTP irá responder com duas (não uma!) Seguindo os cabeçalhos:

1

HTTP/1.1 302 Moved Temporarily
Date: Wed, 24 Dec 2003 15:26:41 GMT
Location: http://testsite.com/redir.php?page=http://other.testsite.com
Content-Length: 0

2

HTTP/1.1 200 OK
Content-Type: text/html
Content-Length: 19
<html>deface</html>


Se o usuário compartilha uma conexão TCP (por exemplo, cache de proxy) e irá enviar um pedido:
/ index.html
a resposta n º 2 será enviada a ele como uma resposta à sua solicitação.
Desta forma, foi possível substituir a página web, que foi servida para o usuário especificado.

Mais informação pode ser encontrada em uma das apresentações sob http://www.owasp.org/images/1/1a/OWASPAppSecEU2006_HTTPMessage